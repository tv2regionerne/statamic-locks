function f(i,t,e,c,s,a,r,d){var n=typeof i=="function"?i.options:i;t&&(n.render=t,n.staticRenderFns=e,n._compiled=!0),c&&(n.functional=!0),a&&(n._scopeId="data-v-"+a);var l;if(r?(l=function(o){o=o||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!o&&typeof __VUE_SSR_CONTEXT__<"u"&&(o=__VUE_SSR_CONTEXT__),s&&s.call(this,o),o&&o._registeredComponents&&o._registeredComponents.add(r)},n._ssrRegister=l):s&&(l=d?function(){s.call(this,(n.functional?this.parent:this).$root.$options.shadowRoot)}:s),l)if(n.functional){n._injectStyles=l;var m=n.render;n.render=function(h,u){return l.call(u),m(h,u)}}else{var _=n.beforeCreate;n.beforeCreate=_?[].concat(_,l):[l]}return{exports:i,options:n}}const p={mixins:[Listing],props:["initialColumns"],data(){return{columns:this.initialColumns,requestUrl:cp_url("statamic-locks/locks")}}};var k=function(){var t=this,e=t._self._c;return e("data-list",{attrs:{"visible-columns":t.columns,columns:t.columns,rows:t.items},scopedSlots:t._u([{key:"default",fn:function({filteredRows:c}){return e("div",{staticClass:"card overflow-hidden p-0 relative"},[e("data-list-table",{scopedSlots:t._u([{key:"cell-title",fn:function({row:s}){return[e("a",{attrs:{href:s.show_url}},[t._v(t._s(s.title))])]}},{key:"actions",fn:function({row:s,index:a}){return[e("dropdown-list",[e("dropdown-item",{staticClass:"warning",attrs:{text:t.__("Delete")},on:{click:function(r){t.$refs[`deleter_${s.id}`].confirm()}}},[e("resource-deleter",{ref:`deleter_${s.id}`,attrs:{resource:s},on:{deleted:t.request}})],1)],1)]}}],null,!0)})],1)}}])})},v=[],b=f(p,k,v,!1,null,null,null,null);const g=b.exports,w={props:{itemId:{type:String,required:!0},itemType:{type:String,required:!0}},data(){return{show:!1,status:[]}},mounted(){this.checkLockStatus(),setInterval(()=>{this.checkLockStatus()},3e4)},methods:{back(){window.history.back()},checkLockStatus(){this.$axios.post(cp_url("statamic-locks/locks"),{item_id:this.itemId,item_type:this.itemType}).then(i=>{if(i.data.error){this.show=!0,this.status=i.data;return}this.show=!1,this.status=[]}).catch(i=>this.handleAxiosError(i))},handleAxiosError(i){this.$toast.error(__("Error getting lock status"))},locks(){window.location.href=cp_route("statamic-locks.locks")}}};var C=function(){var t=this,e=t._self._c;return e("div",[t.show?e("modal",{staticClass:"modal-lock"},[e("div",{staticClass:"flex items-center p-6 bg-gray-200 border-b text-center"},[t._v(" "+t._s(t.__("Item Locked"))+" ")]),e("div",{staticClass:"p-6"},[e("p",{staticClass:"text-base"},[t._v(t._s(t.__("Locked by :name, last updated :since",{name:t.status.locked_by.name,since:t.status.last_updated}))+" ")])]),e("div",{staticClass:"p-4 bg-gray-200 border-t flex items-center justify-end text-sm"},[e("button",{staticClass:"btn btn-close",domProps:{textContent:t._s(t.__("Back"))},on:{click:t.back}}),this.can("view locks")?e("button",{staticClass:"btn ml-4 btn-primary",domProps:{textContent:t._s(t.__("Show locks"))},on:{click:t.locks}}):t._e()])]):t._e()],1)},$=[],S=f(w,C,$,!1,null,null,null,null);const y=S.exports;Statamic.booting(()=>{Statamic.component("statamic-locks-listing",g),Statamic.component("statamic-locks-modal",y)});Statamic.booted(()=>{let i=("/"+Statamic.$config.get("urlPath")).split("/"),t=Statamic.$config.get("statamicLocks")??{};for(let e in t){let c=t[e].split("/"),s=!0,a=0,r="",d="";for(;s&&c.length;){if(r=c.shift(),r=="{id}"){d=i[a];continue}if(!(r=="*"||i[a]==r)){s=!1;continue}a++,c.length&&i.length<a+1&&(s=!1)}s&&d&&!c.length&&Statamic.$components.append("statamic-locks-modal",{props:{itemType:e,itemId:d}})}});
