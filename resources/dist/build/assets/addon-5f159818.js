function f(s,t,e,l,i,o,a,d){var n=typeof s=="function"?s.options:s;t&&(n.render=t,n.staticRenderFns=e,n._compiled=!0),l&&(n.functional=!0),o&&(n._scopeId="data-v-"+o);var c;if(a?(c=function(r){r=r||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!r&&typeof __VUE_SSR_CONTEXT__<"u"&&(r=__VUE_SSR_CONTEXT__),i&&i.call(this,r),r&&r._registeredComponents&&r._registeredComponents.add(a)},n._ssrRegister=c):i&&(c=d?function(){i.call(this,(n.functional?this.parent:this).$root.$options.shadowRoot)}:i),c)if(n.functional){n._injectStyles=c;var m=n.render;n.render=function(h,_){return c.call(_),m(h,_)}}else{var u=n.beforeCreate;n.beforeCreate=u?[].concat(u,c):[c]}return{exports:s,options:n}}const p={mixins:[Listing],props:["initialColumns"],data(){return{columns:this.initialColumns,requestUrl:cp_url("statamic-locks/locks")}}};var v=function(){var t=this,e=t._self._c;return e("data-list",{attrs:{"visible-columns":t.columns,columns:t.columns,rows:t.items},scopedSlots:t._u([{key:"default",fn:function({filteredRows:l}){return e("div",{staticClass:"card overflow-hidden p-0 relative"},[e("data-list-table",{scopedSlots:t._u([{key:"cell-title",fn:function({row:i}){return[e("a",{attrs:{href:i.show_url}},[t._v(t._s(i.title))])]}},{key:"actions",fn:function({row:i,index:o}){return[e("dropdown-list",[e("dropdown-item",{staticClass:"warning",attrs:{text:t.__("Delete")},on:{click:function(a){t.$refs[`deleter_${i.id}`].confirm()}}},[e("resource-deleter",{ref:`deleter_${i.id}`,attrs:{resource:i},on:{deleted:t.request}})],1)],1)]}}],null,!0)})],1)}}])})},g=[],k=f(p,v,g,!1,null,null,null,null);const $=k.exports,C={props:{itemId:{type:String,required:!0},itemType:{type:String,required:!0}},data(){return{show:!1,status:[]}},mounted(){this.checkLockStatus(),setInterval(()=>{this.checkLockStatus()},3e4)},methods:{checkLockStatus(){this.$axios.post(cp_url("statamic-locks/locks"),{item_id:this.itemId,item_type:this.itemType}).then(s=>{if(s.data.error){this.show=!0,this.status=s.data;return}this.show=!1,this.status=[]}).catch(s=>this.handleAxiosError(s))},handleAxiosError(s){this.$toast.error(__("Error getting lock status"))}}};var w=function(){var t=this,e=t._self._c;return e("div",[t.show?e("modal",{staticClass:"modal-lock"},[e("div",{staticClass:"flex items-center p-6 bg-gray-200 border-b text-center"},[t._v(" "+t._s(t.__("Item Locked"))+" ")]),e("div",{staticClass:"p-6"},[e("p",{staticClass:"text-base"},[t._v(t._s(t.__("Locked by :name, last updated :since",{name:t.status.locked_by.name,since:t.status.last_updated}))+" ")])])]):t._e()],1)},S=[],b=f(C,w,S,!1,null,null,null,null);const y=b.exports;Statamic.booting(()=>{Statamic.component("statamic-locks-listing",$),Statamic.component("statamic-locks-modal",y)});Statamic.booted(()=>{let s=("/"+Statamic.$config.get("urlPath")).split("/"),t=Statamic.$config.get("statamicLocks")??{};for(let e in t){let l=t[e].split("/"),i=!0,o=0,a="",d="";for(;i&&l.length;){if(a=l.shift(),a=="{id}"){d=s[o],console.log("got id: "+d);continue}if(!(a=="*"||s[o]==a)){console.log(t[e],o,a,s[o]),i=!1;continue}o++,l.length&&s.length<o+1&&(console.log(t[e]),i=!1)}i&&d&&!l.length&&(console.log(s,o,l,a),Statamic.$components.append("statamic-locks-modal",{props:{itemType:e,itemId:d}}))}});
