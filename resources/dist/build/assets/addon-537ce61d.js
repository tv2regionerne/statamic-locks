function f(s,t,e,c,i,a,r,d){var o=typeof s=="function"?s.options:s;t&&(o.render=t,o.staticRenderFns=e,o._compiled=!0),c&&(o.functional=!0),a&&(o._scopeId="data-v-"+a);var l;if(r?(l=function(n){n=n||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!n&&typeof __VUE_SSR_CONTEXT__<"u"&&(n=__VUE_SSR_CONTEXT__),i&&i.call(this,n),n&&n._registeredComponents&&n._registeredComponents.add(r)},o._ssrRegister=l):i&&(l=d?function(){i.call(this,(o.functional?this.parent:this).$root.$options.shadowRoot)}:i),l)if(o.functional){o._injectStyles=l;var h=o.render;o.render=function(m,u){return l.call(u),h(m,u)}}else{var _=o.beforeCreate;o.beforeCreate=_?[].concat(_,l):[l]}return{exports:s,options:o}}const p={mixins:[Listing],props:["initialColumns"],data(){return{columns:this.initialColumns,requestUrl:cp_url("statamic-locks/locks")}}};var k=function(){var t=this,e=t._self._c;return e("data-list",{attrs:{"visible-columns":t.columns,columns:t.columns,rows:t.items},scopedSlots:t._u([{key:"default",fn:function({filteredRows:c}){return e("div",{staticClass:"card overflow-hidden p-0 relative"},[e("data-list-table",{scopedSlots:t._u([{key:"cell-title",fn:function({row:i}){return[e("a",{attrs:{href:i.show_url}},[t._v(t._s(i.title))])]}},{key:"actions",fn:function({row:i,index:a}){return[i.can_delete?e("dropdown-list",[e("dropdown-item",{staticClass:"warning",attrs:{text:t.__("Delete")},on:{click:function(r){t.$refs[`deleter_${i.id}`].confirm()}}},[e("resource-deleter",{ref:`deleter_${i.id}`,attrs:{resource:i},on:{deleted:t.request}})],1)],1):t._e()]}}],null,!0)})],1)}}])})},v=[],b=f(p,k,v,!1,null,null,null,null);const w=b.exports,g={props:{itemId:{type:String,required:!0},itemType:{type:String,required:!0}},data(){return{show:!1,status:[]}},mounted(){this.checkLockStatus(),setInterval(()=>{this.checkLockStatus()},3e4)},methods:{back(){window.history.back()},deleteLock(){this.status.lock_id||this.$toast.error(__("This isnt possible")),this.$axios.delete(cp_url("statamic-locks/locks/"+this.status.lock_id)).then(s=>{window.location.reload()}).catch(s=>this.handleAxiosError(s))},checkLockStatus(){this.$axios.post(cp_url("statamic-locks/locks"),{item_id:this.itemId,item_type:this.itemType}).then(s=>{if(s.data.error){this.show=!0,this.status=s.data;return}this.show=!1,this.status=[]}).catch(s=>this.handleAxiosError(s))},handleAxiosError(s){this.$toast.error(__("Error getting lock status"))},locks(){window.location.href=cp_url("statamic-locks/locks")}}};var C=function(){var t=this,e=t._self._c;return e("div",[t.show?e("modal",{staticClass:"modal-lock"},[e("div",{staticClass:"flex items-center p-6 bg-gray-200 border-b text-center"},[t._v(" "+t._s(t.__("Item Locked"))+" ")]),e("div",{staticClass:"p-6"},[e("p",{staticClass:"text-base"},[t._v(t._s(t.__("Locked by :name, last updated :since",{name:t.status.locked_by.name,since:t.status.last_updated}))+" ")])]),e("div",{staticClass:"p-4 bg-gray-200 border-t flex items-center justify-between text-sm"},[e("button",{staticClass:"btn",domProps:{textContent:t._s(t.__("Back"))},on:{click:t.back}}),this.can("delete user locks")?e("button",{staticClass:"btn btn-danger",domProps:{textContent:t._s(t.__("Delete lock"))},on:{click:t.deleteLock}}):t._e(),this.can("view locks")?e("button",{staticClass:"btn btn-primary",domProps:{textContent:t._s(t.__("Show locks"))},on:{click:t.locks}}):t._e()])]):t._e()],1)},$=[],S=f(g,C,$,!1,null,null,null,null);const y=S.exports;Statamic.booting(()=>{Statamic.component("statamic-locks-listing",w),Statamic.component("statamic-locks-modal",y)});Statamic.booted(()=>{let s=("/"+Statamic.$config.get("urlPath")).split("/"),t=Statamic.$config.get("statamicLocks")??{};for(let e in t){let c=t[e].split("/"),i=!0,a=0,r="",d="";for(;i&&c.length;){if(r=c.shift(),r=="{id}"){d=s[a];continue}if(!(r=="*"||s[a]==r)){i=!1;continue}a++,c.length&&s.length<a+1&&(i=!1)}i&&d&&!c.length&&Statamic.$components.append("statamic-locks-modal",{props:{itemType:e,itemId:d}})}});
